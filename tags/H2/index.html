<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  

  
  <meta name="keywords" content="tianya,java,notes">
  
  
  
  
  
  
  <title>Tag: H2 | TianwYam</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="keywords" content="tianya,java,notes">
<meta property="og:type" content="website">
<meta property="og:title" content="TianwYam">
<meta property="og:url" content="https://tianwyam.github.io/tags/H2/index.html">
<meta property="og:site_name" content="TianwYam">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="TianwYam">
  
  
    <link rel="icon" href="/css/images/favicon.ico">
  
  <link rel="stylesheet" href="/css/style.css">
  

  
  <!-- baidu webmaster push -->
  <script src="//push.zhanzhang.baidu.com/push.js"></script>
</head></html>
<body class="home blog custom-background custom-font-enabled single-author">
  <div id="page" class="hfeed site">
      <header id="masthead" class="site-header" role="banner">
    <hgroup>
      <h1 class="site-title">
        <a href="/" title="TianwYam" rel="home">TianwYam</a>
      </h1>
      
        <h2 class="site-description">
          <a href="/" id="subtitle">just do it!</a>
        </h2>
      
    </hgroup>

    <nav id="site-navigation" class="main-navigation" role="navigation">
            <button class="menu-toggle">菜单</button>
            <a class="assistive-text" href="/#content" title="跳至内容">跳至内容</a><!--TODO-->
            <div class="menu-main-container">
                <ul id="menu-main" class="nav-menu">
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/">Home</a></li>
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/archives">Archives</a></li>
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://github.com/tianwyam/blog">Fork Me On Github</a></li>
                
                </ul>
            </div>
    </nav>
</header>

      <div id="main" class="wrapper">
        <div id="primary" class="site-content"><div id="content" role="main">
  
    <article id="post-H2内嵌数据库" class="post-H2内嵌数据库 post type-post status-publish format-standard hentry">
    <!---->

      <header class="entry-header">
        
        
  
    <h1 class="entry-title">
      <a class="article-title" href="/2019-03-22-H2内嵌数据库/">H2内嵌数据库的使用</a>
    </h1>
  

        
        <div class="comments-link">
            
            <a href="javascript:void(0);" data-url="https://tianwyam.github.io/2019-03-22-H2内嵌数据库/" data-id="cjtjqqn3b0001wouomdtjkx1a" class="leave-reply bdsharebuttonbox" data-cmd="more">分享</a>
        </div><!-- .comments-link -->
      </header><!-- .entry-header -->

    <div class="entry-content">
      
        <p>[TOC]</p>
<hr>
<h2 id="H2内嵌数据库的使用"><a href="#H2内嵌数据库的使用" class="headerlink" title="H2内嵌数据库的使用"></a>H2内嵌数据库的使用</h2><blockquote>
<p><strong>H2</strong>是一个开源的嵌入式数据库引擎，采用java语言编写，不受平台的限制。</p>
<p>同时H2提供了一个十分方便的web控制台用于操作和管理数据库内容。</p>
<p>H2还提供兼容模式，可以兼容一些主流的数据库，因此采用H2作为开发期的数据库非常方便。 </p>
<p>H2作为一个嵌入型的数据库，它最大的好处就是可以嵌入到我们的Web应用中，和我们的Web应用绑定在一起，成为我们Web应用的一部分。</p>
</blockquote>
<h3 id="运行方式"><a href="#运行方式" class="headerlink" title="运行方式"></a>运行方式</h3><p>H2数据库有三种运行方式实现：</p>
<ol>
<li>嵌入式(embedded)：可以同应用程序打包在一起发布，这样可以非常方便地存储少量结构化数据</li>
<li>服务模式：<br> 1.TCP/IP server：支持客户端/服务器端的连接方式<br> 2.web server：此种运行方式支持使用浏览器访问H2 Console<br> 3.PG server：支持PostgreSQL客户端</li>
<li>内存方式：可以作为缓存，作为NoSQL的一个补充。<br>当某些场景下数据模型必须为关系型，可以拿它当Memcached使，作为后端MySQL/Oracle的一个缓冲层，缓存一些不经常变化但需要频繁访问的数据，比如字典表、权限表。</li>
</ol>
<h3 id="JDBC-URL"><a href="#JDBC-URL" class="headerlink" title="JDBC URL"></a>JDBC URL</h3><p>1、内嵌模式不用启动服务，已内嵌，不用显示启动服务</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String jdbcURL = <span class="string">"jdbc:h2:~/h2/db"</span>;</span><br></pre></td></tr></table></figure>
<p>2、TCP/IP server 服务器模式，必须要显示启动服务</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String jdbcURL = <span class="string">"jdbc:h2:tcp://localhost/~/h2/db"</span>;</span><br></pre></td></tr></table></figure>
<p>3、内存模式 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">String jdbcURL = <span class="string">"jdbc:h2:mem:h2db"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 或者</span></span><br><span class="line"></span><br><span class="line">String jdbcURL = <span class="string">"jdbc:h2:tcp://localhost/mem:h2db"</span>;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Java应用中的使用"><a href="#Java应用中的使用" class="headerlink" title="Java应用中的使用"></a>Java应用中的使用</h2><h3 id="操作实例"><a href="#操作实例" class="headerlink" title="操作实例"></a>操作实例</h3><p>H2数据库基本操作：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ~ 用户目录C:\Users\用户名\</span></span><br><span class="line">String jdbcURL = <span class="string">"不同模式下，不同的jdbcURL，其他操作一样"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//连接数据库时使用的用户名</span></span><br><span class="line"><span class="keyword">final</span> String user = <span class="string">"tianya"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//连接数据库时使用的密码</span></span><br><span class="line">String password = <span class="string">"123456"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//连接H2数据库时使用的驱动类</span></span><br><span class="line"><span class="comment">//org.h2.Driver </span></span><br><span class="line">String driverClass=<span class="string">"org.h2.Driver"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 1、加载驱动</span></span><br><span class="line">	Class.forName(driverClass);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 2、获取连接</span></span><br><span class="line">	Connection connection = DriverManager.getConnection(jdbcURL, user, password);</span><br><span class="line">	Statement statement = connection.createStatement();</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 3、执行操作</span></span><br><span class="line">	<span class="comment">// 3.1、先删除表，若存在</span></span><br><span class="line">	statement.execute(<span class="string">"drop table user_info if exists "</span>);</span><br><span class="line">    </span><br><span class="line">	<span class="comment">// 3.2、创建表</span></span><br><span class="line">	statement.execute(<span class="string">"create table user_info(id int primary key, name varchar(10), age int , sex varchar(2) )"</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 4、新增</span></span><br><span class="line">	statement.executeUpdate(<span class="string">"insert into user_info(id,name,age,sex) values(1,'张三',23,'男' )"</span>);</span><br><span class="line">	statement.executeUpdate(<span class="string">"insert into user_info(id,name,age,sex) values(2,'李四',25,'男' )"</span>);</span><br><span class="line">	statement.executeUpdate(<span class="string">"insert into user_info(id,name,age,sex) values(3,'王五',33,'男' )"</span>);</span><br><span class="line">	statement.executeUpdate(<span class="string">"insert into user_info(id,name,age,sex) values(4,'珠帘',23,'女' )"</span>);</span><br><span class="line">	statement.executeUpdate(<span class="string">"insert into user_info(id,name,age,sex) values(5,'鲤鱼',20,'女' )"</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 5、查询</span></span><br><span class="line">	ResultSet rs = statement.executeQuery(<span class="string">"select * from user_info"</span>);</span><br><span class="line">	<span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">		System.out.println(rs.getInt(<span class="number">1</span>) + <span class="string">" - "</span> + rs.getString(<span class="number">2</span>) </span><br><span class="line">		+ <span class="string">" - "</span> + rs.getInt(<span class="number">3</span>)+ <span class="string">" - "</span> + rs.getString(<span class="number">4</span>) );</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 释放资源</span></span><br><span class="line">	statement.close();</span><br><span class="line">	connection.close();</span><br><span class="line">	</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">	e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Java-web-应用中的使用"><a href="#Java-web-应用中的使用" class="headerlink" title="Java web 应用中的使用"></a>Java web 应用中的使用</h2><h3 id="H2服务的启动"><a href="#H2服务的启动" class="headerlink" title="H2服务的启动"></a>H2服务的启动</h3><h4 id="1-命令行启动服务"><a href="#1-命令行启动服务" class="headerlink" title="1.命令行启动服务"></a>1.命令行启动服务</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">java -cp h2*.jar org.h2.tools.Server -?</span><br><span class="line"></span><br><span class="line">常见的选项如下：</span><br><span class="line"></span><br><span class="line">-web：启动支持H2 Console的服务</span><br><span class="line">-webPort &lt;port&gt;：服务启动端口，默认为8082</span><br><span class="line">-browser：启动H2 Console web管理页面</span><br><span class="line">-tcp：使用TCP server模式启动</span><br><span class="line">-pg：使用PG server模式启动</span><br></pre></td></tr></table></figure>
<p>如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 浏览器web服务方式</span></span><br><span class="line">java -jar h2*.jar org.h2.tools.Server -web -webPort 8082 -browser </span><br><span class="line"></span><br><span class="line"><span class="comment">## TCP服务方式</span></span><br><span class="line">java -jar h2*.jar org.h2.tools.Server -tcp -tcpPort 9092 -tcpSSL</span><br></pre></td></tr></table></figure>
<h4 id="2-Servlet的方式"><a href="#2-Servlet的方式" class="headerlink" title="2.Servlet的方式"></a>2.Servlet的方式</h4><p>注解的方式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tianya.mw.web;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletContext;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletContextEvent;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletContextListener;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletRegistration.Dynamic;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebListener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.log4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.h2.server.web.WebServlet;</span><br><span class="line"><span class="keyword">import</span> org.h2.tools.Server;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Copyright: Copyright (c) 2019 tianwyam</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@ClassName</span>: H2DBServerListener.java</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: 在WEB应用中启动H2数据库服务的监听器</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span>: v1.0.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: tianwyam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2019年3月18日 上午9:56:21</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@WebListener</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">H2DBServerListener</span> <span class="keyword">implements</span> <span class="title">ServletContextListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">transient</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger log = Logger.getLogger(H2DBServerListener.class);</span><br><span class="line">    <span class="comment">// H2 DB 服务</span></span><br><span class="line">	<span class="keyword">private</span> Server server;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">// H2 tcp访问的端口</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> H2_DB_SERVER_PORT = <span class="number">8082</span> ;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextInitialized</span><span class="params">(ServletContextEvent event)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 启动H2数据库服务</span></span><br><span class="line">			log.info(<span class="string">"启动H2数据库..."</span>);</span><br><span class="line">			log.info(String.format(<span class="string">"TCP客户端访问端口：%s"</span>, H2_DB_SERVER_PORT));</span><br><span class="line">			<span class="comment">// 默认端口为8082</span></span><br><span class="line">			server = Server.createTcpServer(</span><br><span class="line">					<span class="string">"-tcpPort"</span>, </span><br><span class="line">					String.valueOf(H2_DB_SERVER_PORT), </span><br><span class="line">					<span class="string">"-tcpAllowOthers"</span>).start();</span><br><span class="line">			log.info(<span class="string">"H2数据库启动成功..."</span>);</span><br><span class="line">			</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 注解方式 添加 H2 DB console 访问 WebServlet</span></span><br><span class="line">			<span class="comment">// 注册 H2数据库 web 控制台  </span></span><br><span class="line">			<span class="comment">// 添加 org.h2.server.web.WebServlet</span></span><br><span class="line">			ServletContext servletContext = event.getServletContext();</span><br><span class="line">			Dynamic webServlet = servletContext.addServlet(<span class="string">"H2Console"</span>, WebServlet.class);</span><br><span class="line">			<span class="comment">// 控制台 访问路径</span></span><br><span class="line">			webServlet.addMapping(<span class="string">"/console/*"</span>);</span><br><span class="line">			webServlet.setLoadOnStartup(<span class="number">1</span>);</span><br><span class="line">			<span class="comment">// 设置配置</span></span><br><span class="line">			Map&lt;String, String&gt; initParameters = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">			initParameters.put(<span class="string">"allowOthers"</span>, <span class="string">"true"</span>);</span><br><span class="line">			initParameters.put(<span class="string">"trace"</span>, <span class="string">"true"</span>);</span><br><span class="line">			webServlet.setInitParameters(initParameters);</span><br><span class="line">			</span><br><span class="line">			log.info(<span class="string">"H2 CONSOLE 默认访问URL：http://localhost:8080/[project_name]/console/"</span>);</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			log.error(<span class="string">"H2数据库启动失败！"</span>, e);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextDestroyed</span><span class="params">(ServletContextEvent event)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 停止服务</span></span><br><span class="line">		<span class="keyword">if</span> (server != <span class="keyword">null</span>) &#123;</span><br><span class="line">			log.info(<span class="string">"关闭H2数据库..."</span>);</span><br><span class="line">			server.shutdown();</span><br><span class="line">			log.info(<span class="string">"关闭H2数据库成功..."</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>web.xml配置方式</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 注册服务监听 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>com.tianya.mw.web.H2DBServerListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 使用H2控制台的Servlet H2控制台是一个独立的应用程序，</span></span><br><span class="line"><span class="comment">包括它自己的Web服务器，但它可以作为一个servlet作为--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>H2Console<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.h2.server.web.WebServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>webAllowOthers<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span><span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>trace<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span><span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 映射H2控制台的访问路径 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>H2Console<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/console/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>访问 查看是否服务启动成功</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://localhost:8080/[project_name]/console/</span></span><br></pre></td></tr></table></figure>
<h4 id="3-maven插件方式"><a href="#3-maven插件方式" class="headerlink" title="3.maven插件方式"></a>3.maven插件方式</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">finalName</span>&gt;</span>LearnH2DB<span class="tag">&lt;/<span class="name">finalName</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- maven插件方式启动 H2 DB 服务 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.codehaus.mojo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>exec-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">goal</span>&gt;</span>java<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">mainClass</span>&gt;</span>org.h2.tools.Server<span class="tag">&lt;/<span class="name">mainClass</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">arguments</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">argument</span>&gt;</span>-web<span class="tag">&lt;/<span class="name">argument</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">argument</span>&gt;</span>-webPort<span class="tag">&lt;/<span class="name">argument</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">argument</span>&gt;</span>8082<span class="tag">&lt;/<span class="name">argument</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">argument</span>&gt;</span>-browser<span class="tag">&lt;/<span class="name">argument</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">arguments</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>执行命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn <span class="built_in">exec</span>:java</span><br></pre></td></tr></table></figure>
<p>相当于</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar h2*.jar org.h2.tools.Server -web -webPort 8082 -browser</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="数据库初始化"><a href="#数据库初始化" class="headerlink" title="数据库初始化"></a>数据库初始化</h3><h4 id="1-maven方式"><a href="#1-maven方式" class="headerlink" title="1.maven方式"></a>1.maven方式</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 初始化 配置  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">profiles</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">profile</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span>&gt;</span>init-db<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-antrun-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">target</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">property</span> <span class="attr">file</span>=<span class="string">"src/main/resources/h2_jdbc.properties"</span> /&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">sql</span> <span class="attr">driver</span>=<span class="string">"$&#123;jdbc.driver&#125;"</span> </span></span><br><span class="line"><span class="tag">								<span class="attr">url</span>=<span class="string">"$&#123;jdbc.url&#125;"</span> </span></span><br><span class="line"><span class="tag">								<span class="attr">userid</span>=<span class="string">"$&#123;jdbc.username&#125;"</span></span></span><br><span class="line"><span class="tag">								<span class="attr">password</span>=<span class="string">"$&#123;jdbc.password&#125;"</span> </span></span><br><span class="line"><span class="tag">								<span class="attr">onerror</span>=<span class="string">"continue"</span></span></span><br><span class="line"><span class="tag">								<span class="attr">encoding</span>=<span class="string">"$&#123;project.build.sourceEncoding&#125;"</span>&gt;</span></span><br><span class="line">								<span class="tag">&lt;<span class="name">classpath</span> <span class="attr">refid</span>=<span class="string">"maven.test.classpath"</span> /&gt;</span></span><br><span class="line">								<span class="tag">&lt;<span class="name">transaction</span> <span class="attr">src</span>=<span class="string">"src/main/resources/sql/h2/schema.sql"</span> /&gt;</span></span><br><span class="line">								<span class="tag">&lt;<span class="name">transaction</span> <span class="attr">src</span>=<span class="string">"src/main/resources/sql/h2/data.sql"</span> /&gt;</span></span><br><span class="line">							<span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">profiles</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>执行命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn antrun:run -P init-db</span><br></pre></td></tr></table></figure>
<h4 id="2-spring方式"><a href="#2-spring方式" class="headerlink" title="2.spring方式"></a>2.spring方式</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">profile</span>=<span class="string">"test"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">ignore-resource-not-found</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">location</span>=<span class="string">"classpath*:/*_jdbc.properties"</span> /&gt;</span>    </span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- Spring Simple连接池 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.SimpleDriverDataSource"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driver&#125;"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.url&#125;"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.username&#125;"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.password&#125;"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- 初始化数据表结构 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">jdbc:initialize-database</span> <span class="attr">data-source</span>=<span class="string">"dataSource"</span> <span class="attr">ignore-failures</span>=<span class="string">"ALL"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">jdbc:script</span> <span class="attr">location</span>=<span class="string">"classpath:sql/h2/schema.sql"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">jdbc:script</span> <span class="attr">location</span>=<span class="string">"classpath:sql/h2/data.sql"</span> <span class="attr">encoding</span>=<span class="string">"UTF-8"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">jdbc:initialize-database</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="项目路径"><a href="#项目路径" class="headerlink" title="项目路径"></a>项目路径</h2><p><a href="https://github.com/tianwyam/LearnProject/tree/master/LearnH2DB" target="_blank" rel="noopener">https://github.com/tianwyam/LearnProject/tree/master/LearnH2DB</a></p>

      
    </div><!-- .entry-content -->

    <footer class="entry-meta">
    <a href="/2019-03-22-H2内嵌数据库/">
    <time datetime="2019-03-22T02:44:58.655Z" class="entry-date">
        2019-03-22
    </time>
</a>
    
  <span class="article-delim">&#8226;</span>
  <div class="article-category">
  <a class="article-category-link" href="/categories/数据库/">数据库</a>/<a class="article-category-link" href="/categories/数据库/java/">java</a>
  </div>

    
  <span class="article-delim">&#8226;</span>
  <div>
  	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/H2/">H2</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/">java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/maven/">maven</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spring/">spring</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/内嵌数据库/">内嵌数据库</a></li></ul>
  </div>
  

    </footer>
</article>






  
  

</div></div>
        <div id="secondary" class="widget-area" role="complementary">
  
    
<aside class="widget">
	<h3 class="widget-title">关于我</h3>
	
	<div class="widget-content">
		
		<p>邮箱：tianya.mw@qq.com</p>
		<p>QQ：1129064096</p>
		<div class="github-card user-card">
			<div class="header User"></div>
			<a class="avatar" href="https://github.com/tianwyam" target="_top">
				<img src="https://avatar.gitee.com/uploads/51/1088151_tianyagongmingyue.png!avatar100?1477980572" alt="tianya" style="border-radius:50%;opacity: 0.8;">
			</a>
		</div>
	</div>
	
	<div class="widget-content">
		<h1>tianwyam</h1>
	</div>
	
</aside>
  
    
  <aside class="widget">
    <h3 class="widget-title">Music</h3>
    <div class="widget-content">
    	张靓颖【我的梦】
      <video autoplay="autoplay" name="media" loop="loop">
      	<source src="http://www.ytmp3.cn/down/57682.mp3" type="audio/mpeg">
      </video>
    </div>
  </aside>

  
    
  <aside class="widget">
    <h3 class="widget-title">Archives</h3>
    <div class="widget-content">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </aside>

  
    
  <aside class="widget">
    <h3 class="widget-title">Recents</h3>
    <div class="widget-content">
      <ul>
        
          <li>
            <a href="/2019-03-22-H2内嵌数据库/">H2内嵌数据库的使用</a>
          </li>
        
      </ul>
    </div>
  </aside>

  
    
  <aside class="widget">
    <h3 class="widget-title">Categories</h3>
    <div class="widget-content">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/数据库/">数据库</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/数据库/java/">java</a><span class="category-list-count">1</span></li></ul></li></ul>
    </div>
  </aside>

  
    
  <aside class="widget">
    <h3 class="widget-title">Tags</h3>
    <div class="widget-content">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/H2/">H2</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/maven/">maven</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring/">spring</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/内嵌数据库/">内嵌数据库</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </aside>

  
    
  <aside class="widget">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget-content tagcloud">
      <a href="/tags/H2/" style="font-size: 10px;">H2</a> <a href="/tags/java/" style="font-size: 10px;">java</a> <a href="/tags/maven/" style="font-size: 10px;">maven</a> <a href="/tags/spring/" style="font-size: 10px;">spring</a> <a href="/tags/内嵌数据库/" style="font-size: 10px;">内嵌数据库</a>
    </div>
  </aside>

  
    
<aside class="widget">
	<h3 class="widget-title">友情链接</h3>
	
	<div class="widget-content">
		<p><a href="https://me.csdn.net/mybook201314">CSDN</a></p>
		<p><a href="https://gitee.com/tianyagongmingyue">gitee</a></p>
	</div>
	
</aside>
  
</div>
      </div>
      <footer id="colophon" role="contentinfo">
    <p>&copy; 2019 tianwyam
    All rights reserved.</p>
    <p>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a></p>
</footer>
    <script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"1","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"16"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/js/share.js'];</script>

<script src="/js/jquery-3.3.1.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

<script src="/js/navigation.js"></script>

<div id="bg"></div>

  </div>
</body>
</html>